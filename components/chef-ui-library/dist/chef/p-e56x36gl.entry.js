import{r as t,d as s,h as i,H as h,c as e}from"./p-1b10ccda.js";import"./p-d7ac2f15.js";import{d as n,r as a,G as o,N as r,J as c}from"./p-464ede08.js";import{r as d,f as l}from"./p-7cba3003.js";import{g as p}from"./p-f76e3d4b.js";import{r as f}from"./p-b19cfb27.js";import{c as u}from"./p-95d7fd9f.js";var m=n("findIndex",d);m.placeholder=a;var v=m,b=n("lte",function(t,s){return"string"==typeof t&&"string"==typeof s||(t=o(t),s=o(s)),function(t,s){return t<=s}(t,s)});b.placeholder=a;var w=b,x=function(t,s){return t>s},g=n("max",function(t){return t&&t.length?function(t,s,i){for(var h=-1,e=t.length;++h<e;){var n=t[h],a=s(n);if(null!=a&&(void 0===o?a==a&&!r(a):i(a,o)))var o=a,c=n}return c}(t,c,x):void 0},f);g.placeholder=a;var y=g;class E{constructor(i){t(this,i),this.disabled=!1,this.options=[],this.selectedIndex=0,this.selectedContent="",this.focusedIndex=0,this.focused=!1,this.active=!1,this.minWidth=0,this.change=s(this,"change",7)}handleFocus(){this.disabled||(this.focused=!0)}handleFocusOut(t){const s=t.relatedTarget;t.stopPropagation(),s&&"CHEF-DROPDOWN"===s.nodeName||(this.focused=!1,this.active=!1)}handleClickActivation(t){if(!this.disabled)if(this.active){const s=t.target.closest("chef-option");if(!s)return;this.makeSelection(v(["optionId",s.optionId],this.options))}else this.activate(this.selectedIndex)}handleKeydown(t){switch(t.key){case" ":case"Enter":return this.handleKeyActivation();case"Escape":return this.handleEscape();case"ArrowUp":return this.handleUp(t);case"ArrowDown":return this.handleDown(t)}}handleKeyActivation(){this.disabled||(this.active?this.makeSelection(this.focusedIndex):this.activate(this.selectedIndex))}handleEscape(){this.active=!1,this.focusedIndex=this.selectedIndex}handleUp(t){t.preventDefault(),this.focusedIndex=this.clamp(this.focusedIndex-1)}handleDown(t){t.preventDefault(),this.focusedIndex=this.clamp(this.focusedIndex+1)}componentDidLoad(){this.options=Array.from(this.el.querySelectorAll("chef-option"));const t=[v(["value",this.value],this.options),v("selected",this.options),0],s=this.clamp(l(w(0),t));this.value=p("",[s,"value"],this.options),this.selectedIndex=s,this.focusedIndex=s,this.syncOptions(s)}async componentWillUpdate(){const t=Promise.all(this.options.map(t=>t.getWidth()));this.minWidth=y(await t)||0;const s=this.options[this.selectedIndex];this.selectedContent=s?await s.getContent():""}render(){const t=this.options[this.focusedIndex],s={minWidth:`${this.minWidth+20}px`},e=[this.focused?"focused":"",this.active?"active":"",this.disabled?"disabled":""].join(" ");return i(h,{role:"combobox",class:e,style:s,tabindex:this.disabled?"-1":"0",highlighted:p("","optionId",t)},i("span",{class:"selected-value",role:"button","aria-haspopup":"listbox","aria-expanded":this.active},i("span",{class:"option-content",innerHTML:this.selectedContent}),i("chef-icon",{"aria-hidden":!0},"expand_more")),i("div",{class:"options"},i("chef-dropdown",{tabindex:"-1",visible:this.active,role:"listbox","aria-activedescendant":p("","optionId",t)},i("slot",null))))}clamp(t){return u(0,this.options.length-1,t)}makeSelection(t){const s=new CustomEvent("change");this.selectedIndex=t,this.active=!1,this.value=p("",[t,"value"],this.options),this.change.emit(s),this.syncOptions(t)}activate(t){const s=this.el.querySelector("chef-dropdown");this.active=!0,this.focusedIndex=this.clamp(t),s.focus()}syncOptions(t){this.options[t]&&(this.options.forEach(t=>t.selected=!1),this.options[t].selected=!0)}get el(){return e(this)}static get style(){return"chef-select{outline:none;border-radius:var(--chef-border-radius);border-color:var(--chef-grey);display:inline-block;background-color:var(--chef-white);cursor:pointer}chef-select .selected-value{display:block;padding:1em 3.5em 1em 1em;border-radius:inherit;border:1px solid;border-color:inherit;position:relative;-webkit-transition:border-color .5s ease;transition:border-color .5s ease}chef-select .selected-value chef-icon{position:absolute;right:.75em;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);font-size:1.25em}chef-select .selected-value:not(.disabled) .selected-value{cursor:pointer}chef-select.focused .selected-value{border-color:var(--chef-primary-bright)}chef-select.active .selected-value{border-bottom-left-radius:0;border-bottom-right-radius:0;z-index:102}chef-select .options{width:100%;position:relative}chef-select chef-dropdown{width:100%;border:1px solid;border-color:var(--chef-primary-bright);border-top:none;border-top-left-radius:0;border-top-right-radius:0;outline:none;z-index:101}chef-select chef-option{display:block;padding:1em 3em 1em 1.5em;border-bottom:1px solid var(--chef-grey);cursor:pointer;color:inherit;position:relative;white-space:nowrap}chef-select chef-option:last-child{border-bottom:0}chef-select chef-option:hover{background-color:var(--chef-lightest-grey);color:var(--chef-primary-bright);outline:none}chef-select chef-option .option-content{overflow:hidden;text-overflow:ellipsis;display:inline-block;width:100%}"}}export{E as chef_select};